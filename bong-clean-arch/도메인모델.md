# BuckPal 도메인 모델 명세서

## 1. 핵심 개념 정의

### 1.1 계좌 (Account)
**계좌**는 사용자가 돈을 보관하고 거래할 수 있는 금융 단위입니다.

**상태**
- **정상 (Active)**: 모든 거래가 가능한 상태
- **정지 (Suspended)**: 어떤 거래도 할 수 없는 상태

**속성**
- 계좌 고유 식별자
- 현재 상태 (정상/정지)
- 잔고
- 거래 내역

---

### 1.2 거래 (Transaction/Activity)
**거래**는 계좌 간 또는 계좌에서 발생하는 금전적 행위를 의미합니다.

**거래 유형**
- **송금 (Transfer)**: 내 계좌에서 상대방 계좌로 돈을 보내는 행위
- **인출 (Withdrawal)**: 내 계좌에서 돈이 나가는 행위

**거래 기록 정보**
- 거래 고유 식별자
- 거래 유형 (송금/인출)
- 거래 시각
- 거래 금액
- 거래 후 잔고

---

### 1.3 돈 (Money)
**돈**은 계좌 맥락에서 금액을 표현하는 단위입니다.

**제약사항**
- 금액은 양수만 가능 (0원 포함 여부는 추가 논의 필요)
- 소수점 이하 처리 방식 (반올림/절사 규칙)

---

## 2. 비즈니스 규칙

### 2.1 계좌 생성 규칙
```
규칙 R1: 계좌를 생성하면 기본 상태는 '정상'이다.
규칙 R2: 새로 생성된 계좌의 초기 잔고는 0원이다.
```

---

### 2.2 계좌 상태 전환 규칙
```
규칙 R3: '정상' 상태의 계좌는 관리자 또는 시스템에 의해 '정지' 상태로 전환될 수 있다.
규칙 R4: '정지' 상태의 계좌는 모든 거래 시도가 실패한다.
규칙 R5: '정지' 상태의 계좌는 다른 계좌로부터 송금을 받을 수 없다.
```

---

### 2.3 송금 규칙
```
규칙 R6: 송금은 두 개의 계좌 사이에서만 발생한다. (송금인 계좌 → 수취인 계좌)

규칙 R7: 송금이 가능한 조건
  - 송금인 계좌가 '정상' 상태여야 한다
  - 수취인 계좌가 '정상' 상태여야 한다
  - 송금인 계좌의 잔고가 송금액 이상이어야 한다
  - 송금인과 수취인이 서로 다른 계좌여야 한다

규칙 R8: 자기 자신의 계좌로는 송금할 수 없다.

규칙 R9: 송금이 성공하면
  - 송금인 계좌의 잔고가 송금액만큼 감소한다
  - 수취인 계좌의 잔고가 송금액만큼 증가한다
  - 각 계좌에 거래 내역이 기록된다
```

---

### 2.4 인출 규칙
```
규칙 R10: 인출이 가능한 조건
  - 계좌가 '정상' 상태여야 한다
  - 계좌 잔고가 인출액 이상이어야 한다

규칙 R11: 인출이 성공하면
  - 계좌의 잔고가 인출액만큼 감소한다
  - 계좌에 거래 내역이 기록된다
```

---

### 2.5 거래 내역 규칙
```
규칙 R12: 모든 거래는 거래 내역으로 기록된다.

규칙 R13: 거래 내역에는 다음 정보가 포함된다
  - 거래 유형 (송금/인출)
  - 거래 시각 (언제 발생했는지)
  - 거래 금액
  - 거래 후 잔고

규칙 R14: 거래 내역은 계좌별로 조회할 수 있다.
```

---

## 3. 시나리오 예시

### 시나리오 1: 정상적인 송금
```
상황:
- A 계좌: 정상 상태, 잔고 10,000원
- B 계좌: 정상 상태, 잔고 5,000원

행위: A 계좌에서 B 계좌로 3,000원 송금

결과:
✅ 송금 성공
- A 계좌 잔고: 7,000원
- B 계좌 잔고: 8,000원
- 각 계좌에 거래 내역 기록됨
```

---

### 시나리오 2: 잔고 부족으로 송금 실패
```
상황:
- A 계좌: 정상 상태, 잔고 2,000원
- B 계좌: 정상 상태, 잔고 5,000원

행위: A 계좌에서 B 계좌로 3,000원 송금

결과:
❌ 송금 실패 (규칙 R7 위반: 잔고 부족)
- 계좌 잔고 변화 없음
- 거래 내역 기록 안됨
```

---

### 시나리오 3: 정지 계좌로 송금 시도
```
상황:
- A 계좌: 정상 상태, 잔고 10,000원
- B 계좌: 정지 상태, 잔고 5,000원

행위: A 계좌에서 B 계좌로 3,000원 송금

결과:
❌ 송금 실패 (규칙 R5, R7 위반: 수취인 계좌가 정지 상태)
- 계좌 잔고 변화 없음
- 거래 내역 기록 안됨
```

---

### 시나리오 4: 자기 계좌로 송금 시도
```
상황:
- A 계좌: 정상 상태, 잔고 10,000원

행위: A 계좌에서 A 계좌로 3,000원 송금

결과:
❌ 송금 실패 (규칙 R8 위반: 자기 자신에게 송금 불가)
- 계좌 잔고 변화 없음
- 거래 내역 기록 안됨
```

---

## 4. 추가 논의 필요 사항

### 4.1 Money (돈) 관련
- **Q1**: 0원 송금/인출이 가능해야 하는가?
- **Q2**: 음수 금액을 시스템에서 어떻게 처리할 것인가? (입력 단계에서 차단 vs 도메인에서 검증)
- **Q3**: 소수점 금액 처리 규칙은? (예: 123.456원 → 123원? 124원?)

### 4.2 계좌 상태 관련
- **Q4**: '정지' 외에 다른 상태가 필요한가? (예: 휴면, 폐쇄 등)
- **Q5**: 계좌 상태 전환 이력을 기록해야 하는가?

### 4.3 거래 내역 관련
- **Q6**: 거래 내역 조회 시 기간 제한이 있는가?
- **Q7**: 대량 거래 내역 조회 시 페이징이 필요한가?

### 4.4 송금 한도 관련
- **Q8**: 일일 송금 한도, 1회 송금 한도 등의 제한이 필요한가?

---

## 5. 용어 사전

| 용어 | 의미 | 영문 용어 |
|------|------|-----------|
| 계좌 | 돈을 보관하고 거래하는 금융 단위 | Account |
| 거래 | 계좌에서 발생하는 금전적 행위 | Transaction/Activity |
| 송금 | 한 계좌에서 다른 계좌로 돈을 보내는 행위 | Transfer |
| 인출 | 계좌에서 돈이 나가는 행위 | Withdrawal |
| 잔고 | 계좌에 현재 보관된 금액 | Balance |
| 정상 상태 | 모든 거래가 가능한 계좌 상태 | Active |
| 정지 상태 | 모든 거래가 불가능한 계좌 상태 | Suspended |
| 거래 내역 | 과거에 발생한 거래의 기록 | Activity History |

---

이 문서는 Phase 1의 도메인 모델링을 기반으로 작성되었으며, 개발 구성원(개발자, 기획자, QA 등) 간 공통 이해를 위한 멘탈 모델을 제공합니다.
